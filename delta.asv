function d=delta(energyall,wfall,param)
%wfall(k,level,:)
Nk=size(wfall,1);
mat=zeros(4);
mat(4,1)=1;
mat(3,2)=-1;
d=0;
for kindex=1:Nk
    vec1=squeeze(wfall(kindex,1,:)); 
    vec2=squeeze(wfall(kindex,2,:));
%     d=d+param.g*(vec1'*mat*vec1+vec2'*mat*vec2);
     d=d+param.g*(vec1(1)*vec2())
end
% d=d/(2*Nk);
d=d/(Nk);
end
