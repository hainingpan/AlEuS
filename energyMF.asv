%wfall(k,level,:)
function [energyall,wfall]=energyMF(d,param)
Nk=param.Nk;
energyall=zeros(Nk,4);
wfall=zeros(Nk,4,4);
sz=param.sz;
sy=param.sy;
sx=param.sx;
s0=param.s0;
T=zeros(4,4,Nk);
D=zeros(4,4,Nk);
Z=zeros(4,4,Nk);

for kindex=1:Nk
    T(:,:,kindex)=kron(sz,s0)*energylist(kindex);
    D(:,:,kindex)=kron(sy,sy)*d;
    Z(:,:,kindex)=param.Ez*kron(sz,sx);
end

H=T+D+Z;



